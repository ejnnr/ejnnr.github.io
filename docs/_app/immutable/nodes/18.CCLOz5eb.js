import{t as H,a as N}from"../chunks/ZND8Q6sY.js";import"../chunks/D1wvszJw.js";import{f as O,s as a,c as s,b as t,n as e}from"../chunks/CXEaPN9q.js";import{h as n}from"../chunks/CkMDHBy_.js";import{s as x}from"../chunks/dy7G579c.js";import{l as W,s as X}from"../chunks/lNFSlT5-.js";import{_ as Z}from"../chunks/BInqBSHA.js";const F=""+new URL("../assets/random-vs-grid.CuIC0s9V.png",import.meta.url).href,K=""+new URL("../assets/uniform.DN2fy_xG.png",import.meta.url).href,Q=""+new URL("../assets/stretched.Dgxue2XE.png",import.meta.url).href,L={title:"Visualizing random vs grid search",summary:`Random search usually works better than grid search
  for hyperparameter optimization. This brief post suggests a way
  to visualize the reason for this geometrically.
  `,date:"2021-12-22T00:00:00.000Z",draft:!1,tags:["Machine learning"],image:{preview_only:"true"}},{title:la,summary:oa,date:ha,draft:ca,tags:ga,image:da}=L;var aa=H(`<p>The following figure<sup id="fnref-1"><a href="#fn-1" class="footnote-ref">1</a></sup> is a good illustration of why random search
typically works better than grid search for hyperparameter optimization: <img></p> <p>The idea here is that the performance depends on two hyperparameters, <span class="math math-inline"><!></span> and <span class="math math-inline"><!></span>, and one of them (<span class="math math-inline"><!></span> in this case) is much more important.
More specifically, the performance can be written as <span class="math math-inline"><!></span>,
where <span class="math math-inline"><!></span> is the green curve at the top and <span class="math math-inline"><!></span> the yellow curve
on the side.</p> <p>Both random and grid search test 9 different <span class="math math-inline"><!></span> pairs. But random
search also tests 9 different values of <span class="math math-inline"><!></span>, whereas grid search tests only 3.
So since the <span class="math math-inline"><!></span>-dependency dominates overall performance, random search
will very likely find a better parameter combination.</p> <p>I’d like to show another visualization of this idea,
by stretching the space of hyperparameters to illustrate their relative
importance.</p> <p>If we have two hyperparameters that are equally important to overall
performance, grid and random search look as follows: <img> You should imagine that the best hyperparameter combination lies at some unknown
point in these squares. The goal is to have tested at least one point relatively
close to this optimum.<sup id="fnref-2"><a href="#fn-2" class="footnote-ref">2</a></sup> Grid search is looking pretty good from that perspective.</p> <p>But this figure is very misleading if one of the parameters is much more important
than the other. In that case, we care a lot more about the distance along
the important axis. We can visualize this by stretching the space of hyperparameters
so that the more important hyperparameter has a longer axis: <img> In this stretched figure, we can just look at distances without worrying
about the different axes, because the geometry of the space already takes
the relative importance of the two hyperparameters into account.</p> <p>Suddenly, grid search doesn’t look that great anymore, and random search is actually
better at “uniformly” filling out the hyperparameter space under this new geometry.</p> <p>If we knew the relative importance of the two hyperparameters,
we could improve grid search by having more grid points along the more important
axis---but often we <em>don’t</em> know that, at least not very precisely. And
for random search, it luckily doesn’t matter.</p> <div class="footnotes"><hr> <ol><li id="fn-1">James Bergstra and Yoshua Bengio: Random Search for Hyper-Parameter Optimization, <a href="https://www.jmlr.org/papers/volume13/bergstra12a/bergstra12a.pdf" rel="nofollow">https://www.jmlr.org/papers/volume13/bergstra12a/bergstra12a.pdf</a><a href="#fnref-1" class="footnote-backref">↩</a></li> <li id="fn-2">This is a different sort of simplifying assumption
than we had above: now, the overall performance cannot necessarily be decomposed
as <span class="math math-inline"><!></span>. Instead, we assume that performance depends monotonically
on the weighted distance <span class="math math-inline"><!></span>. Just like the previous assumption
of additivity, this is pretty unrealistic, but I think it still serves as
a good intuition.<a href="#fnref-2" class="footnote-backref">↩</a></li></ol></div>`,1);function ya($,I){const R=W(I,["children","$$slots","$$events","$$legacy"]);Z($,X(()=>R,L,{children:(T,sa)=>{var w=aa(),m=O(w),B=a(s(m),3);x(B,"src",F),t(m);var p=a(m,2),i=a(s(p)),P=s(i);n(P,()=>'<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>'),t(i);var r=a(i,2),S=s(r);n(S,()=>'<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span>'),t(r);var l=a(r,2),U=s(l);n(U,()=>'<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>'),t(l);var o=a(l,2),j=s(o);n(j,()=>'<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>+</mo><mi>g</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(x) + g(y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span>'),t(o);var h=a(o,2),G=s(h);n(G,()=>'<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span>'),t(h);var v=a(h,2),V=s(v);n(V,()=>'<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">g(y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span>'),t(v),e(),t(p);var c=a(p,2),g=a(s(c)),q=s(g);n(q,()=>'<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x, y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span>'),t(g);var d=a(g,2),C=s(d);n(C,()=>'<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>'),t(d);var b=a(d,2),D=s(b);n(D,()=>'<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>'),t(b),e(),t(c);var y=a(c,4),J=a(s(y));x(J,"src",K),e(3),t(y);var f=a(y,2),Y=a(s(f));x(Y,"src",Q),e(),t(f);var k=a(f,6),_=a(s(k),2),M=a(s(_),2),u=a(s(M)),A=s(u);n(A,()=>'<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>+</mo><mi>g</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(x) + g(y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span>'),t(u);var z=a(u,2),E=s(z);n(E,()=>'<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><msub><mi>x</mi><mtext>opt</mtext></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo>+</mo><mi>b</mi><mo stretchy="false">(</mo><mi>y</mi><mo>−</mo><msub><mi>y</mi><mtext>opt</mtext></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">a(x - x_{\\text{opt}})^2 + b(y - y_{\\text{opt}})^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1002em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">opt</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1002em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">opt</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>'),t(z),e(2),t(M),t(_),t(k),N(T,w)},$$slots:{default:!0}}))}export{ya as component};
